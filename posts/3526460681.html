<!DOCTYPE html><html lang="zh-CN"><head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="BLJJ-DBLD">


    <meta name="subtitle" content="å¾®ä»»åŠ¡">




<title>P5 setState è¯¦ç»†è§£æ &amp; React æ€§èƒ½ä¼˜åŒ– | BLJJ-DBLD Blog</title>



    <link rel="icon" href="https://cdn.reorz.com/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    
    
    
    



    <!-- scripts list from _config.yml -->
    
    
    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/js/lightgallery.min.js"></script>
    
    
    



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SSN1WL65KY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SSN1WL65KY');
</script>

<meta name="generator" content="Hexo 5.4.0"><script>function loadCss(l){var d=document,h=d.head,s=d.createElement('link');s.rel='stylesheet';s.href=l;!function e(f){if (d.body)return f();setTimeout(function(){e(f)})}(function(){h.appendChild(s);});}loadCss('/style.css');loadCss('https://cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/css/lightgallery.min.css');</script><noscript><link rel="stylesheet" href="/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/css/lightgallery.min.css"></noscript></head>

<body>
    

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">&lt; BLJJ-DBLD blog /&gt;</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">å½’æ¡£</a>
                
                    <a class="menu-item" href="/categories">åˆ†ç±»</a>
                
                    <a class="menu-item" href="/tags">æ ‡ç­¾</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">&lt; BLJJ-DBLD blog /&gt;</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">â˜° Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">å½’æ¡£</a>
                
                    <a class="menu-item" href="/categories">åˆ†ç±»</a>
                
                    <a class="menu-item" href="/tags">æ ‡ç­¾</a>
                
            </div>
        </div>
    </nav>

</header>

            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>


    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">P5 setState è¯¦ç»†è§£æ &amp; React æ€§èƒ½ä¼˜åŒ–</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">BLJJ-DBLD</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">åäºŒæœˆ 7, 2021&nbsp;&nbsp;6:03:26</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/React/">React</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="ä¸ºä»€ä¹ˆä½¿ç”¨-setState"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-setState" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ setState"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ setState</h1><p>åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥é€šè¿‡ä¿®æ”¹ state çš„å€¼æ¥è®©ç•Œé¢å‘ç”Ÿæ›´æ–°ï¼Œå› ä¸º React å¹¶æ²¡æœ‰å®ç°ç±»ä¼¼ Vue2 ä¸­ Object.definedProerty æˆ–è€… Vue3 ä¸­çš„ Proxy çš„æ–¹å¼ç›‘å¬æ•°æ®çš„å˜åŒ–ï¼›æˆ‘ä»¬å¿…é¡»é€šè¿‡ setState æ¥å‘ŠçŸ¥ React æ•°æ®å‘ç”Ÿäº†æ”¹å˜</p>
<blockquote>
<p>åœ¨ç»„ä»¶ä¸­å¹¶æ²¡æœ‰å®ç°å¯¹ setState çš„æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆå¯ä»¥è°ƒç”¨å‘¢ï¼Ÿ</p>
<p>åŸå› æ˜¯ï¼ŒsetState æ˜¯ä» Component ä¸­ç»§æ‰¿è¿‡æ¥çš„ã€‚</p>
</blockquote>
<h1 id="setState-æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Ÿæˆ‘ä»¬æ¥æ¢ç©¶ä¸€ä¸‹"><a href="#setState-æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Ÿæˆ‘ä»¬æ¥æ¢ç©¶ä¸€ä¸‹" class="headerlink" title="setState æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Ÿæˆ‘ä»¬æ¥æ¢ç©¶ä¸€ä¸‹"></a>setState æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Ÿæˆ‘ä»¬æ¥æ¢ç©¶ä¸€ä¸‹</h1><h2 id="ä¸ºä»€ä¹ˆ-setState-è®¾è®¡ä¸ºå¼‚æ­¥å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-setState-è®¾è®¡ä¸ºå¼‚æ­¥å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ setState è®¾è®¡ä¸ºå¼‚æ­¥å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ setState è®¾è®¡ä¸ºå¼‚æ­¥å‘¢ï¼Ÿ</h2><ol>
<li>setState è®¾è®¡ä¸ºå¼‚æ­¥ï¼Œå¯ä»¥æ˜¾è‘—çš„æå‡æ€§èƒ½ï¼›<ul>
<li>å¦‚æœæ¯æ¬¡è°ƒç”¨ setState éƒ½è¿›è¡Œä¸€æ¬¡æ›´æ–°ï¼Œé‚£ä¹ˆæ„å‘³ç€ render æ–¹æ³•ä¼šè¢«é¢‘ç¹è°ƒç”¨ï¼Œç•Œé¢é‡æ–°æ¸²æŸ“ï¼Œè¿™æ ·æ•ˆç‡ä¼šå¾ˆä½ï¼›</li>
<li>æœ€å¥½çš„åŠæ³•åº”è¯¥æ˜¯è·å–åˆ°å¤šä¸ªæ›´æ–°ï¼Œä¹‹åè¿›è¡Œæ‰¹é‡æ›´æ–°</li>
</ul>
</li>
<li>å¦‚æœåŒæ­¥æ›´æ–°äº† stateï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œ render å‡½æ•°ï¼Œé‚£ä¹ˆçˆ¶ç»„ä»¶å†…çš„ state ä¸å­ç»„ä»¶å†…çš„ prop å°†ä¸èƒ½ä¿æŒåŒæ­¥ã€‚<ul>
<li>state å’Œ props ä¸èƒ½ä¿æŒä¸€è‡´ï¼Œä¼šåœ¨å¼€å‘ä¸­äº§ç”Ÿå¾ˆå¤šçš„é—®é¢˜</li>
</ul>
</li>
</ol>
<h2 id="å¦‚ä½•è·å–å¼‚æ­¥çš„ç»“æœ"><a href="#å¦‚ä½•è·å–å¼‚æ­¥çš„ç»“æœ" class="headerlink" title="å¦‚ä½•è·å–å¼‚æ­¥çš„ç»“æœ"></a>å¦‚ä½•è·å–å¼‚æ­¥çš„ç»“æœ</h2><p>æ–¹å¼ä¸€ï¼šé€šè¿‡ setState çš„ç¬¬äºŒä¸ªå‚æ•°ï¼ˆå›è°ƒå‡½æ•°ï¼‰ç­‰å¾…æ›´æ–°åï¼Œå†å»è·å–å…·ä½“çš„å€¼</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;!-- setState(æ›´æ–°çš„ state å±æ€§, å›è°ƒå‡½æ•°) --&gt;</span><br><span class="line"><span class="built_in">this</span>.setState({</span><br><span class="line">    <span class="attr">message</span>: <span class="built_in">this</span>.state.message</span><br><span class="line">}, <span class="function">() =&gt;</span> {</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.state.message)</span><br><span class="line">})</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>

<p>æ–¹å¼äºŒï¼šåœ¨ <code>componentDidUpdate</code> æ–¹æ³•ä¸­è·å–åˆ°æ›´æ–°åçš„å½“å‰å€¼</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="function"><span class="title">componentDidUpdate</span>(<span class="params"></span>)</span> {</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.state.message)</span><br><span class="line">}</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>æ–¹å¼äºŒä¼šåœ¨æ–¹å¼ä¸€ä¹‹å‰è¢«è°ƒç”¨åˆ°ã€‚</p>
</blockquote>
<h2 id="setState-ä¸€å®šæ˜¯å¼‚æ­¥çš„å—ï¼Ÿ"><a href="#setState-ä¸€å®šæ˜¯å¼‚æ­¥çš„å—ï¼Ÿ" class="headerlink" title="setState ä¸€å®šæ˜¯å¼‚æ­¥çš„å—ï¼Ÿ"></a>setState ä¸€å®šæ˜¯å¼‚æ­¥çš„å—ï¼Ÿ</h2><blockquote>
<p>é¦–å…ˆè¯´å‡ºç»“è®ºï¼šä¸ä¸€å®šçš„ã€‚</p>
</blockquote>
<p>å…¶å®æ˜¯åˆ†ä¸ºä¸¤ç§çš„ï¼š</p>
<ul>
<li>åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæˆ– React åˆæˆäº‹ä»¶ä¸­ï¼ŒsetState æ˜¯å¼‚æ­¥çš„ï¼›</li>
<li>åœ¨ <code>setTimeout</code> æˆ–è€…åŸç”Ÿ <code>DOM</code> äº‹ä»¶å†…ï¼ŒsetState æ˜¯åŒæ­¥çš„ï¼›</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯-React-çš„åˆæˆäº‹ä»¶ï¼Ÿä¸ºä»€ä¹ˆè¦è¿™æ ·å­åšï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-React-çš„åˆæˆäº‹ä»¶ï¼Ÿä¸ºä»€ä¹ˆè¦è¿™æ ·å­åšï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ React çš„åˆæˆäº‹ä»¶ï¼Ÿä¸ºä»€ä¹ˆè¦è¿™æ ·å­åšï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ React çš„åˆæˆäº‹ä»¶ï¼Ÿä¸ºä»€ä¹ˆè¦è¿™æ ·å­åšï¼Ÿ</h3><ol>
<li>ä»€ä¹ˆæ˜¯ React çš„åˆæˆäº‹ä»¶ï¼šæŒ‡çš„æ˜¯ jsx ä¸­çš„äº‹ä»¶ç»‘å®šï¼Œä¾‹å¦‚ <code>onClick</code> ç­‰æ­¤ç±»äº‹ä»¶ã€‚ç”šè‡³äºï¼Œåˆæˆäº‹ä»¶å†…çš„ <code>event</code> å¯¹è±¡ä¹Ÿæ˜¯ React åˆæˆçš„ã€‚</li>
<li>ä¸ºä½•è¦å¦‚æ­¤åšæ³•ï¼š<ul>
<li>å› ä¸º React ä¸ä»…ä»…æƒ³è¦è·‘åœ¨æµè§ˆå™¨ä¸­ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ React-Native çš„è¯ï¼Œæ˜¯è·‘åœ¨åŸç”Ÿçš„æ‰‹æœºä¸Šçš„ã€‚</li>
<li>æˆ‘ä»¬åœ¨ React çš„ render æ–¹æ³•å†…ç¼–å†™çš„éƒ½æ˜¯ jsx ä»£ç ï¼Œå½“è·‘åœ¨æµè§ˆå™¨ä¸Šï¼Œé‚£å°±æ„å‘³ç€åˆ°æ—¶å€™æµè§ˆå™¨äº§ç”Ÿçš„ DOM äº‹ä»¶å¯¹è±¡ <code>event</code> ç»™åˆ° Reactï¼›</li>
<li>å¦‚æœ React æ˜¯è·‘åœ¨åŸç”Ÿæ‰‹æœºä¸Šæ—¶ï¼Œå°±éœ€è¦ç»™åˆ°åŸç”Ÿæ§ä»¶çš„å¯¹è±¡ã€‚</li>
<li>æ‰€ä»¥ï¼Œå½“ä½ åœ¨å†™è¿™ä¸ªä»£ç çš„æ—¶å€™ï¼Œ React æ˜¯ä¸æ˜ç¡®ä½ åˆ°åº•è·‘åœ¨å“ªä¸ªå¹³å°ä¸Šçš„</li>
<li>æ—¢ç„¶ä¸æ˜ç¡®ï¼Œé‚£ React å°±å°†è¿™ä¸ªäº‹ä»¶å¯¹è±¡æ”¹æˆåˆæˆå¯¹è±¡ã€‚</li>
<li>æ”¹æˆåˆæˆå¯¹è±¡åçš„å¥½å¤„æ˜¯ï¼šå¦‚æœæ˜¯è·‘åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘å°±å°†æµè§ˆå™¨äº‹ä»¶å¯¹è±¡ä¸æˆ‘çš„å…¶ä»–å±æ€§ åˆæˆåˆ° åˆæˆå¯¹è±¡å½“ä¸­ï¼›å¦‚æœæ˜¯è·‘åœ¨åŸç”Ÿå½“ä¸­ï¼Œæˆ‘å°±å°† <code>Button</code> æˆ–è€…å…¶ä»–åŸç”Ÿæ§ä»¶çš„ç›¸å…³å±æ€§ä¸æˆ‘çš„å…¶ä»–å±æ€§ åˆæˆåˆ° åˆæˆå¯¹è±¡å½“ä¸­ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p>æ€»ç»“ï¼šåˆæˆå¯¹è±¡ <code>event</code> ä¼šæ ¹æ®ä¸åŒçš„å¹³å°ï¼ˆæµè§ˆå™¨ / åŸç”Ÿï¼‰ä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ã€‚</p>
</blockquote>
<h3 id="åœ¨-React-å½“ä¸­ï¼Œåˆ°åº•æ˜¯å¦‚ä½•å†³å®šæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"><a href="#åœ¨-React-å½“ä¸­ï¼Œåˆ°åº•æ˜¯å¦‚ä½•å†³å®šæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ" class="headerlink" title="åœ¨ React å½“ä¸­ï¼Œåˆ°åº•æ˜¯å¦‚ä½•å†³å®šæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"></a>åœ¨ React å½“ä¸­ï¼Œåˆ°åº•æ˜¯å¦‚ä½•å†³å®šæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ</h3><blockquote>
<p>æ¢ç©¶æºç ï¼š</p>
<p>æ€»ç»“ï¼šReact æºç å½“ä¸­åšè¿‡ä¸€ä¸ªåˆ¤æ–­ï¼Œå®ƒä¼šæ ¹æ®æˆ‘ä»¬å½“å‰å¤„äºçš„ä¸Šä¸‹æ–‡ä¸åŒæƒ…å†µæ¥è¿”å›å½“å‰è¿™é‡Œåˆ°åº•æ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ </p>
</blockquote>
<h1 id="setState-ä¸­çš„åˆå¹¶"><a href="#setState-ä¸­çš„åˆå¹¶" class="headerlink" title="setState ä¸­çš„åˆå¹¶"></a>setState ä¸­çš„åˆå¹¶</h1><h2 id="setState-ä¸­çš„æ•°æ®åˆå¹¶"><a href="#setState-ä¸­çš„æ•°æ®åˆå¹¶" class="headerlink" title="setState ä¸­çš„æ•°æ®åˆå¹¶"></a>setState ä¸­çš„<strong>æ•°æ®</strong>åˆå¹¶</h2><p>ä¸Šæºç è®²è§£ï¼š</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"> <span class="built_in">this</span>.state = { <span class="attr">message</span>: <span class="string">'Hello World'</span>, <span class="attr">name</span>: <span class="string">'jamediii'</span> }</span><br><span class="line">...</span><br><span class="line">changeMessage () {</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">message</span>: <span class="string">'hello jamediii'</span></span><br><span class="line">    })</span><br><span class="line">}</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>

<p>æ­¤æ—¶çš„ <code>name</code> å¹¶ä¸ä¼šæ¶ˆå¤±ï¼Œå› ä¸ºåœ¨ React å¯¹ state çš„æ›´æ–°æ‰‹æ³•æ˜¯ï¼š<code>Object.assgin({}, prevState, partialState)</code></p>
<h2 id="setState-ä¸­è‡ªèº«çš„åˆå¹¶"><a href="#setState-ä¸­è‡ªèº«çš„åˆå¹¶" class="headerlink" title="setState ä¸­è‡ªèº«çš„åˆå¹¶"></a>setState ä¸­è‡ªèº«çš„åˆå¹¶</h2><p>ä¾æ—§ä¸Šæºç ï¼š</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">increment () {</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">count</span>: <span class="built_in">this</span>.state.count + <span class="number">1</span></span><br><span class="line">    });</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">count</span>: <span class="built_in">this</span>.state.count + <span class="number">1</span></span><br><span class="line">    });</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">count</span>: <span class="built_in">this</span>.state.count + <span class="number">1</span></span><br><span class="line">    });</span><br><span class="line">}</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>

<p>è¿™ä¸ªæ˜¯ä¹‹å‰çš„è®¡æ•°å™¨æ¡ˆä¾‹ï¼Œæ­¤æ—¶æˆ‘å¤šæ¬¡è°ƒç”¨ <code>setState</code> æ–¹æ³•ï¼Œè¾“å‡ºçš„ count ä¼šæ˜¯å¤šå°‘å‘¢ï¼Ÿ</p>
<blockquote>
<p>ç»“è®ºï¼šä¼šè¾“å‡º <code>1</code></p>
</blockquote>
<p>ä¸ºä»€ä¹ˆä¸æ˜¯ <code>3</code> å‘¢ï¼Ÿ</p>
<ul>
<li>åŸå› æ˜¯ï¼š React ä¼šå¯¹ <code>setState</code> æ–¹æ³•è¿›è¡Œå†…éƒ¨åˆå¹¶ï¼Œè™½ç„¶è¢«è°ƒç”¨äº†ä¸‰æ¬¡ï¼Œä½†æ˜¯ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå¯¹è±¡ï¼Œè€Œè¿™ä¸€ä¸ªå¯¹è±¡ï¼ˆæœ€åè°ƒç”¨çš„ <code>setState</code> å¯¹è±¡ï¼‰ï¼Œæ‰æ˜¯æœ€ç»ˆæˆ‘ä»¬æ›´æ–°çš„çš„å¯¹è±¡ã€‚</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬å°†ä»£ç ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">increment () {</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">count</span>: <span class="built_in">this</span>.state.count + <span class="number">1</span></span><br><span class="line">    });</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">count</span>: <span class="built_in">this</span>.state.count + <span class="number">2</span></span><br><span class="line">    });</span><br><span class="line">    <span class="built_in">this</span>.setState({</span><br><span class="line">        <span class="attr">count</span>: <span class="built_in">this</span>.state.count + <span class="number">3</span></span><br><span class="line">    });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>æŒ‰ç…§ä¹‹å‰çš„ç»“è®ºï¼Œæ¯æ¬¡è¾“å‡ºæ˜¯ï¼š+ <code>3</code></p>
<p>ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬æœ‰å¹¶ä¸å¸Œæœ›æ˜¯å½“å‰çš„ç»“æœï¼Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯æ¯ä¸€æ¬¡è°ƒç”¨ <code>setState</code> åè·å–åˆ°çš„ç»“æœç´¯åŠ ã€‚æ­¤æ—¶ï¼Œ<code>setState</code> æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¸ºå‡½æ•°è¿™ä¸ªä¼˜ç‚¹å°±æœ‰æ‰€ä½“ç°äº†ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºå‡½æ•°æ—¶ï¼Œéœ€è¦ä¼ é€’å‚æ•°ã€‚</p>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">increment () {</span><br><span class="line">    <span class="built_in">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">count</span>: prevState.count + <span class="number">1</span></span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">    <span class="built_in">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">count</span>: prevState.count + <span class="number">1</span></span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">    <span class="built_in">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> {</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="attr">count</span>: prevState.count + <span class="number">1</span></span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>ç»“è®ºæ˜¯ï¼šè¾“å‡º <code>3</code>; ohhhhhhhh!</p>
</blockquote>
<blockquote>
<p>æ€»ç»“æ¥è¯´ï¼šæ ¹æ® <code>setState</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŒ‡ å¯¹è±¡ï¼Œè¿˜æ˜¯ å‡½æ•°ï¼Œä¼šæœ‰ä¸åŒçš„æ“ä½œã€‚</p>
<ol>
<li><p>å½“å‚æ•°æ˜¯å¯¹è±¡æ—¶ï¼Œä¼šå¯¹å¤šä¸ª <code>setState</code> åªä¼šåˆå¹¶å¹¶ä¸”åªä¼šå°†æœ€åä¸€æ¬¡çš„ <code>setState</code> æ–¹æ³•è¿›è¡Œæ‰§è¡Œ</p>
</li>
<li><p>å½“å‚æ•°æ—¶å‡½æ•°æ—¶ï¼Œä¼šå¯¹å¤šä¸ª <code>setState</code> è¿›è¡Œåˆå¹¶ï¼Œä½†æ˜¯ï¼Œä¼šå°†æ¯æ¬¡çš„å‡½æ•°éƒ½æ‰§è¡Œä¸€æ¬¡ï¼›å‡½æ•°ä¸­éœ€è¦è‡³å°‘ä¼ é€’ä¸€ä¸ªå‚æ•° <code>prevState</code> æŒ‡ä»£çš„æ˜¯ä¸Šä¸€æ¬¡æ‰§è¡Œåçš„ <code>state</code> å€¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå°±å¯ä»¥åœ¨ä¸Šæ¬¡çš„å‰æä¸‹è¿›è¡Œç´¯åŠ æ“ä½œäº†ã€‚</p>
</li>
</ol>
</blockquote>
<h1 id="React-çš„æ›´æ–°æœºåˆ¶"><a href="#React-çš„æ›´æ–°æœºåˆ¶" class="headerlink" title="React çš„æ›´æ–°æœºåˆ¶"></a>React çš„æ›´æ–°æœºåˆ¶</h1><p>React çš„æ¸²æŸ“æµç¨‹ï¼š<code>jsx -&gt; è™šæ‹Ÿ DOM -&gt; çœŸå® DOM</code></p>
<p>React çš„æ›´æ–°æµç¨‹ï¼š<code>props/state æ”¹å˜ -&gt; render æ–¹æ³•çš„é‡æ–°æ‰§è¡Œ â€”&gt; ä¼šäº§ç”Ÿæ–°çš„è™šæ‹Ÿ DOM æ ‘ -&gt; æ–°æ—§è™šæ‹Ÿ DOM æ ‘ä½œ diff æ¯”è¾ƒ -&gt; è®¡ç®—å‡ºå·®å¼‚è¿›è¡Œæ›´æ–° -&gt; æ›´æ–°åˆ°çœŸå®çš„ DOM ä¸Š</code></p>
<p>æ¯ä¸€æ¬¡è¿›è¡Œæ¯”è¾ƒæ›´æ–°æ—¶ï¼Œå³ä½¿æ˜¯æœ€å…ˆè¿›çš„ç®—æ³•ï¼Œè¯¥ç®—æ³•çš„å¤æ‚ç¨‹åº¦ä¸º <code>O(n^3)</code>ï¼Œå…¶ä¸­ <code>n</code> æ˜¯æŒ‡æ ‘ä¸­å…ƒç´ ä¸ªæ•°ã€‚</p>
<p>å‡å¦‚é¡µé¢ä¸­å±•ç¤º 1000 ä¸ªå…ƒç´ ï¼Œé‚£æ‰€éœ€è¦çš„æ‰§è¡Œçš„è®¡ç®—é‡å°†åœ¨ åäº¿çš„é‡çº§èŒƒå›´ï¼›è¿™ç§å¼€é”€å¤ªè¿‡æ˜‚è´µï¼Œä¼šä½¿å¾— React æ›´æ–°æ€§èƒ½å˜å¾—éå¸¸ä½æ•ˆã€‚</p>
<p>äºæ˜¯ï¼ŒReact å¯¹ç®—æ³•è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå°†å…¶ä¼˜åŒ–æˆäº† <code>O(n)</code>ï¼Œå…·ä½“çš„ä¼˜åŒ–è¿‡ç¨‹ï¼š</p>
<ul>
<li>åªä¼šå¯¹åŒå±‚èŠ‚ç‚¹ä¹‹é—´ç›¸äº’æ¯”è¾ƒï¼Œä¸ä¼šè·¨èŠ‚ç‚¹æ¯”è¾ƒï¼›</li>
<li>æ–°æ—§ DOM æ ‘ä¸Šï¼ŒåŒå±‚çš„èŠ‚ç‚¹å‘ç”Ÿç±»å‹æ”¹å˜æ—¶ï¼Œä¼šé‡é“¸è¯¥èŠ‚ç‚¹åŠä»¥ä¸‹çš„æ‰€æœ‰èŠ‚ç‚¹ï¼›</li>
<li>å¼€å‘ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>key</code> æ¥æŒ‡å®šå“ªäº›èŠ‚ç‚¹åœ¨ä¸åŒçš„æ¸²æŸ“ä¸‹ä¿æŒç¨³å®šï¼›</li>
</ul>
<ol>
<li>æƒ…å†µä¸€ï¼šå¯¹æ¯”ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œä¼šè§¦å‘ <code>componentUnmount -&gt; componentDidMount</code><ul>
<li>å½“èŠ‚ç‚¹ä¸ºä¸åŒçš„å…ƒç´ ï¼ŒReact ä¼šæ‹†å¸åŸæœ‰çš„æ ‘ï¼Œå¹¶ä¸”å»ºç«‹èµ·æ–°çš„æ ‘</li>
<li>æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼šReact ä¼šé”€æ¯ Counter ç»„ä»¶å¹¶ä¸”é‡æ–°è£…è½½ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè€Œä¸ä¼šå¯¹ Counter è¿›è¡Œå¤ç”¨ã€‚  <figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸå…ˆçš„ jsx </span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">	<span class="xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment">// æ›´æ–°åçš„ jsx</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
<li>æƒ…å†µäºŒï¼šå¯¹æ¯”åŒä¸€ç±»å‹çš„å…ƒç´ ï¼Œä¼šè§¦å‘ <code>componentDidUpdate</code><ul>
<li>å½“æ¯”è¾ƒä¸¤ä¸ªç›¸åŒç±»å‹çš„ React å…ƒç´ æ—¶ï¼ŒReact ä¼šä¿ç•™ DOM èŠ‚ç‚¹ï¼Œä»…å¯¹æ¯”æ›´æ–°æœ‰æ”¹å˜çš„å±æ€§ã€‚</li>
<li>æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼šé€šè¿‡æ¯”è¾ƒï¼ŒReact çŸ¥é“åªéœ€è¦ä¿®æ”¹ DOM å…ƒç´ ä¸Šçš„ className å±æ€§  <figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸå…ˆçš„ jsx</span></span><br><span class="line">&lt;div className=<span class="string">"before"</span> title=<span class="string">"stuff"</span> /&gt;</span><br><span class="line"><span class="comment">// æ›´æ–°åçš„ jsx</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"after"</span> <span class="attr">title</span>=<span class="string">"stuff"</span> /&gt;</span></span></span><br></pre></td></tr></tbody></table></figure></li>
<li>åˆæ¯”å¦‚ï¼Œå½“æ›´æ–° style ä¸­çš„æŸä¸ªå±æ€§æ—¶ï¼ŒReact ä»…æ›´æ–°æœ‰æ‰€æ›´å˜çš„å±æ€§ã€‚</li>
<li>é€šè¿‡å¯¹æ¯”è¿™ä¸¤ä¸ªå…ƒç´ ï¼ŒReact çŸ¥é“åªéœ€è¦ä¿®æ”¹ DOM å…ƒç´ ä¸Šçš„ color æ ·å¼ï¼Œæ— éœ€ä¿®æ”¹ fontWeight  <figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸå…ˆçš„ jsx</span></span><br><span class="line">&lt;div style={{<span class="attr">color</span>: <span class="string">'red'</span>, <span class="attr">fontWeight</span>: <span class="string">'blod'</span>}} /&gt;</span><br><span class="line"><span class="comment">// æ›´æ–°åçš„ jsx</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">{{color:</span> '<span class="attr">green</span>', <span class="attr">fontWeight:</span> '<span class="attr">blod</span>'}} /&gt;</span></span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
<li>æƒ…å†µä¸‰ï¼šå¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’<ul>
<li>é»˜è®¤æ¡ä»¶ä¸‹ï¼Œå½“é€’å½’ DOM èŠ‚ç‚¹çš„å­å…ƒç´ æ—¶ï¼ŒReact ä¼šåŒæ—¶éå†ä¸¤ä¸ªå­å…ƒç´ çš„åˆ—è¡¨ï¼Œå½“äº§ç”Ÿå·®å¼‚æ—¶ï¼Œç”Ÿæˆä¸€ä¸ª mutationã€‚</li>
<li>å½“åªæ˜¯å‘åˆ—è¡¨çš„å°¾éƒ¨æ’å…¥æ•°æ®æ—¶ï¼Œä¸ä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Œä½†å¦‚æœæ˜¯å‘åˆ—è¡¨çš„ä¸­é—´æˆ–è€…å¤´éƒ¨æ’å…¥æ•°æ®æ—¶ï¼Œå°±ä¼šå¯¼è‡´æ’å…¥çš„æ•°æ®ä¹‹åçš„å…ƒç´ é‡æ–°æ„å»ºï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚</li>
<li>æ­¤æ—¶ï¼Œ <code>key</code> çš„å‡ºç°ï¼Œå°±æ˜¯ä¸ºäº†ä¼˜åŒ–è¿™ä¸€ç‚¹ï¼Œå®ƒä¼šæ¯”è¾ƒåˆ—è¡¨ä¸­æ¯ä¸€é¡¹çš„ key &amp; å…ƒç´ æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´æ—¶å°±ä¸ä¼šè¢«é‡æ„ï¼Œåªä¼šå°†ä½ç½®è¿›è¡Œç½®æ¢ã€‚</li>
<li>ä½¿ç”¨ <code>key</code> æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ul>
<li>key åº”è¯¥æ˜¯åœ¨å½“å‰æ ¹èŠ‚ç‚¹ä¸‹å”¯ä¸€çš„ï¼›</li>
<li>key å°½é‡ä¸è¦ä½¿ç”¨éšæœºæ•°</li>
<li>ä½¿ç”¨ index ä½œä¸º key æ—¶ï¼Œå¯¹æ€§èƒ½æ˜¯æ²¡æœ‰ä¼˜åŒ–çš„</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="render-æ–¹æ³•è¢«æ— æ•ˆè°ƒç”¨"><a href="#render-æ–¹æ³•è¢«æ— æ•ˆè°ƒç”¨" class="headerlink" title="render æ–¹æ³•è¢«æ— æ•ˆè°ƒç”¨"></a>render æ–¹æ³•è¢«æ— æ•ˆè°ƒç”¨</h2><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ä¹‹å‰çš„ä¸€ä¸ªåµŒå¥—æ¡ˆä¾‹ï¼šå½“ App ä¸­ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªè®¡æ•°å™¨çš„ä»£ç ï¼›å½“ç‚¹å‡» +1 æ—¶ï¼Œä¼šé‡æ–°è°ƒç”¨ render æ–¹æ³•ï¼Œè€Œå½“ App çš„ render æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ‰€æœ‰çš„å­ç»„ä»¶çš„ render æ–¹æ³•ä¹Ÿä¼šè¢«é‡æ–°è°ƒç”¨ï¼›</p>
<p>é‚£ä¹ˆï¼Œåªè¦æ ¹ç»„ä»¶çš„ render è¢«é‡æ–°è°ƒç”¨ï¼Œé‚£æ‰€æœ‰å­ç»„ä»¶ä¹Ÿéœ€è¦è¢«è¿«é‡æ–° renderï¼Œå½“è¿›è¡Œ diff ç®—æ³•æ—¶ï¼Œæ€§èƒ½å¿…ç„¶å¾ˆä½ï¼›</p>
<p>äº‹å®ä¸Šï¼Œå¾ˆå¤šçš„ç»„ä»¶åªè¦æ²¡æœ‰æ¶‰åŠåˆ°è‡ªèº«çš„æ›´æ”¹æ—¶ï¼Œæ˜¯æ²¡æœ‰å¿…è¦é‡æ–° render çš„ï¼Œå®ƒä»¬è°ƒç”¨ render æ—¶åº”è¯¥æœ‰ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯ä¾èµ–çš„æ•°æ®ï¼ˆstate / propsï¼‰å‘ç”Ÿäº†æ›´æ–°ï¼Œå†è°ƒç”¨è‡ªå·±çš„ render æ–¹æ³•</p>
<p>é‚£å¦‚ä½•è‡ªç”±çš„æ§åˆ¶ç»„ä»¶å†…çš„ render æ˜¯å¦è¢«è°ƒç”¨å‘¢ï¼Ÿç­”æ¡ˆæ˜¯é€šè¿‡ <code>shouldComponentUpdate</code> æ–¹æ³•å³å¯ï¼›</p>
<h3 id="shouldComponentUpdate-æ–¹æ³•"><a href="#shouldComponentUpdate-æ–¹æ³•" class="headerlink" title="shouldComponentUpdate æ–¹æ³•"></a>shouldComponentUpdate æ–¹æ³•</h3><p>React æä¾›äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³• <code>shouldComponentUpdate</code>ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—å‚æ•°ã€‚å¹¶ä¸”éœ€è¦æœ‰è¿”å›å€¼ï¼š</p>
<ul>
<li>è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼ˆnextProps, nextStateï¼‰å‡è¿”å›æœ€æ–°çš„å‚æ•°æ•°æ®ã€‚</li>
<li>è¯¥æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ª boolean ç±»å‹ï¼š<ul>
<li>å½“è¿”å›å€¼ä¸º true æ—¶ï¼Œé‚£å°±ä¼šè°ƒç”¨ render æ–¹æ³•</li>
<li>å½“è¿”å›å€¼ä¸º false æ—¶ï¼Œå°†ä¸ä¼šè°ƒç”¨ render æ–¹æ³•</li>
<li>é»˜è®¤è¿”å›æ˜¯ trueï¼Œä¹Ÿå°±æ˜¯åªè¦ state å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šè°ƒç”¨ render æ–¹æ³•</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>shouldComponentUpdate</code> æ–¹æ³•è™½å¥½ï¼Œä½†æ˜¯ä¹Ÿä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>éœ€è¦åœ¨æ¯ä¸€ä¸ªç»„ä»¶å†…ä¸€æ¬¡æ¬¡çš„å£°æ˜è¯¥æ–¹æ³•</li>
<li>æ— æ³•å¯¹å‡½æ•°ç»„ä»¶ä½¿ç”¨è¯¥æ–¹æ³•</li>
</ol>
</blockquote>
<h3 id="PureComponent-ç±»"><a href="#PureComponent-ç±»" class="headerlink" title="PureComponent ç±»"></a>PureComponent ç±»</h3><p>åªèƒ½æ˜¯ç±»ç»„ä»¶é€šè¿‡ç»§æ‰¿ <code>PureComponent</code> ç±»ï¼š</p>
<ol>
<li>æ£€æµ‹è¯¥ç»„ä»¶ä¸­æ˜¯å¦æœ‰ä½¿ç”¨ shouldComponentUpdate æ–¹æ³•ã€‚<ol>
<li>å½“ç»„ä»¶å†…ä½¿ç”¨äº†è¯¥æ–¹æ³•æ—¶ï¼Œå°±ä¼šæŒ‰ç…§è¯¥æ–¹æ³•çš„è¾“å‡ºæ¥å†³å®šæ˜¯å¦è¿›è¡Œ renderã€‚</li>
<li>å½“æœªä½¿ç”¨æ—¶ï¼Œåœ¨ <code>PureComponent</code> ç±»ä¸­ä¼šé€šè¿‡ <code>checkShouldComponentUpdate</code> æ–¹æ³•å¯¹æ–°æ—§ <code>props, state, context</code> æ¯”è¾ƒï¼Œå½“è¿”å› true æ—¶æ‰ä¼šè¿›è¡Œ renderã€‚</li>
</ol>
</li>
<li>æ¯”è¾ƒæ—¶ï¼Œåªæ˜¯è¿›è¡Œæµ…å±‚æ¯”è¾ƒã€‚</li>
<li>ä¸å»ºè®®åœ¨ <code>shouldComponentUpdate</code> ä¸­è¿›è¡Œæ·±å±‚æ¯”è¾ƒæˆ–ä½¿ç”¨ <code>JSON.stringify()</code>ï¼ŒåŸå› æ˜¯è¿™æ ·éå¸¸å½±å“æ•ˆç‡ï¼Œä¸”ä¼šæŸå®³æ€§èƒ½ã€‚<blockquote>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŸºæœ¬å¯ä»¥ä½¿ç”¨ <code>PureComponent</code> æ¥ä»£æ›¿ <code>Component</code> çš„ä½¿ç”¨ã€‚å› ä¸º <code>PureComponent</code> åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿä¼˜åŒ–æˆ‘ä»¬çš„æ€§èƒ½ã€‚</p>
</blockquote>
</li>
</ol>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> {PureComponent} <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Children</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>{</span><br><span class="line">    render () {</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>å­ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="memo-é«˜é˜¶å‡½æ•°ç»„ä»¶"><a href="#memo-é«˜é˜¶å‡½æ•°ç»„ä»¶" class="headerlink" title="memo é«˜é˜¶å‡½æ•°ç»„ä»¶"></a>memo é«˜é˜¶å‡½æ•°ç»„ä»¶</h3><blockquote>
<p>é«˜é˜¶å‡½æ•°ç»„ä»¶ï¼šèƒ½å¤Ÿå¯¹ä¸€ä¸ªå‡½æ•°æ“ä½œå¹¶ä¸”è¿”å›ä¸€ä¸ªå‡½æ•°</p>
</blockquote>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> {memo} <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å¼ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> MemoChildren = memo(<span class="function"><span class="keyword">function</span> <span class="title">Children</span> (<span class="params"></span>) </span>{</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>å­ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h1 id="é’»ä¸ªğŸ‚å°–"><a href="#é’»ä¸ªğŸ‚å°–" class="headerlink" title="é’»ä¸ªğŸ‚å°–"></a>é’»ä¸ªğŸ‚å°–</h1><h2 id="æ·±å…¥ç†è§£-setState-çš„â€œå¼‚æ­¥â€"><a href="#æ·±å…¥ç†è§£-setState-çš„â€œå¼‚æ­¥â€" class="headerlink" title="æ·±å…¥ç†è§£ setState çš„â€œå¼‚æ­¥â€"></a>æ·±å…¥ç†è§£ <code>setState</code> çš„â€œå¼‚æ­¥â€</h2><p>Q: <code>setState</code> ä¸ºä»€ä¹ˆç»™äººçš„æ„Ÿè§‰æ˜¯å¼‚æ­¥çš„ï¼Ÿ</p>
<p>A:<br>åœ¨ <code>setState()</code> ä¹‹åæ— æ³•ç«‹å³è·å–åˆ°æœ€æ–°çš„ <code>state</code></p>
<p>Q: é‚£ä¸ºä»€ä¹ˆ <code>React</code> è¦æŠŠçŠ¶æ€çš„æ›´æ–°è®¾è®¡æˆè¿™ç§æ–¹å¼å‘¢ï¼Ÿç›´æ¥ <code>this.state.count = 1</code> ä¸å¥½å—ï¼Ÿ</p>
<p>A:<br>é¦–å…ˆï¼Œ<code>this.state.count = 1</code> è¿™èˆ¬åšæ³•æ˜¯ä¸èƒ½è§¦å‘æ›´æ–°ã€‚ <code>React</code> ä¸ <code>Vue</code> ä¸åŒï¼Œ<code>Vue</code> æ˜¯å“åº”å¼ç³»ç»Ÿï¼ˆReactivity Systemï¼‰ï¼Œåœ¨ Vue3 ä¸­é€šè¿‡ <code>Proxy</code> ç›‘å¬å¯¹è±¡æˆ– Vue2.x ä¸­é€šè¿‡ <code>Object.defineProperty</code> ç›‘å¬å¯¹è±¡çš„å±æ€§æ¥å®ç°æ›´æ–°è§†å›¾çš„ã€‚è€Œ <code>React</code> æ˜¯é€šè¿‡ <code>setState()</code> è§¦å‘æ›´æ–°è§†å›¾çš„ã€‚</p>
<p><code>React</code> è®¾è®¡æˆè¿™ç§æ–¹å¼çš„åŸå› ï¼Œè®¾è®¡è€…å·²ç»æ­£é¢å›ç­”äº†ã€‚<a target="_blank" rel="noopener" href="https://github.com/facebook/react/issues/11527#issuecomment-360199710">ç‚¹è¿™é‡Œ</a>ã€‚æ€»ç»“èµ·æ¥ï¼š</p>
<ul>
<li>ä¿è¯å†…éƒ¨çš„ä¸€è‡´æ€§ï¼šå³ä½¿ <code>state</code> æ˜¯åŒæ­¥æ›´æ–°ï¼Œ<code>props</code> ä¹Ÿä¸æ˜¯ã€‚ï¼ˆä½ åªæœ‰åœ¨çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶æ‰èƒ½çŸ¥é“<code>props</code>ï¼‰</li>
<li>å°† <code>state</code> çš„æ›´æ–°å»¶ç¼“åˆ°æœ€åæ‰¹é‡åˆå¹¶å†å»æ¸²æŸ“å¯¹äºåº”ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ˜¯æœ‰æå¤§å¥½å¤„çš„ï¼Œå¦‚æœæ¯æ¬¡çš„çŠ¶æ€æ”¹å˜éƒ½å»é‡æ–°æ¸²æŸ“çœŸå®domï¼Œé‚£ä¹ˆå®ƒå°†å¸¦æ¥å·¨å¤§çš„æ€§èƒ½æ¶ˆè€—ã€‚</li>
</ul>
<p>Q: <code>setState</code> çœŸçš„æ˜¯å¼‚æ­¥å—ï¼Ÿ</p>
<p>A:<br>å…¶å®ä¸ç„¶ï¼Œ<code>setState</code> å†…éƒ¨æ˜¯æ²¡æœ‰ç¼–å†™å¼‚æ­¥ä»£ç çš„ã€‚å®ƒåªæ˜¯æ¨¡æ‹Ÿäº†å¼‚æ­¥çš„è¡Œä¸ºã€‚å°±åƒä¸Šæ–‡è¯´çš„ï¼Œ<code>setState</code> æ ¹æ®<strong>ä¸Šä¸‹æ–‡ç¯å¢ƒ</strong>æ¥åˆ¤æ–­æ˜¯å¼‚æ­¥æ›´æ–°è¿˜æ˜¯åŒæ­¥æ›´æ–°ã€‚å†é€šä¿—ç‚¹æ˜¯ï¼Œ<code>React</code> ä¼šç»´æŠ¤ä¸€ä¸ªæ ‡è¯†ï¼ˆ<code>isBatchingUpdates</code>ï¼‰ï¼Œåˆ¤æ–­æ˜¯ç›´æ¥æ›´æ–°è¿˜æ˜¯å…ˆæš‚å­˜ state åˆ°é˜Ÿåˆ—ã€‚</p>
<p>è€Œè¿™ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒæŒ‡çš„æ˜¯æ‰§è¡Œ <code>setState</code> æ–¹æ³•æ—¶ï¼Œæ˜¯åœ¨ åˆæˆæ–¹æ³•å’Œé’©å­å‡½æ•°ã€1ã€‘ ä¸­ï¼Œè¿˜æ˜¯åœ¨ åŸç”Ÿäº‹ä»¶å’Œ <code>setTimeout</code>ã€2ã€‘ ä¸­ã€‚åœ¨ ã€1ã€‘ ä¸­ä¼šè¡¨ç°æˆ â€œå¼‚æ­¥â€ï¼Œåœ¨ ã€2ã€‘ ä¸­æ—¶ä¼šè¡¨ç°æˆ åŒæ­¥ã€‚å¹¶ä¸”åœ¨ â€œå¼‚æ­¥â€ çŠ¶æ€ä¸‹ï¼Œ<code>setState</code> ä¼šè¿›è¡Œæ‰¹é‡æ›´æ–°ä¼˜åŒ–ï¼Œå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡ <code>setState</code>ï¼Œ<code>setState</code> çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå»æœ€åä¸€æ¬¡çš„æ‰§è¡Œï¼›å¦‚æœæ˜¯åŒæ—¶å¤šä¸ªå€¼è¿›è¡Œå¤šæ¬¡ <code>setState</code>ï¼Œåˆ™ä¼šåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>BLJJ-DBLD</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://bljj-dbld.github.io/posts/3526460681.html">https://bljj-dbld.github.io/posts/3526460681.html</a></span>
                    </p>
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/posts/1641527773.html">P6-å‰é¢çš„çŸ¥è¯†ç‚¹è¡¥å……</a>
            
            
            <a class="next" rel="next" href="/posts/1385832995.html">P4 React ç»„ä»¶åŒ–å¼€å‘</a>
            
        </section>
        <!-- <section class="post-comment">
            <div id="disqus_thread"></div>
        </section> -->

    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>
            Â© 2015-2022 BLJJ-DBLD | Elegant theme by Chic | <a href="https://stats.uptimerobot.com/J8kXJc8qlg" target="_blank">Status</a>
        </span>
    </div>
</footer>

    </div>


<script src="/bundle.js"></script><script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Light"
            }
        })();
    ;

    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
;

    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script></body></html>