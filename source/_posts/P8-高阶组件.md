---
title: P8 高阶组件 & 组件的补充
tags: []
categories:
  - React
abbrlink: 4158548198
date: 2021-12-07 19:24:51
---

# 认识高阶函数

> 高阶函数的定义，至少满足以下条件之一：
> - 接受一个或多个函数作为输入；
> - 输出一个函数；

其中 `Array` 中常用的高阶函数有：`map, reduce, filter, sort`。

那么，高阶组件又是什么呢？
- 高阶组件的英文名: `Heigh-Order Component`，简称为 `HOC`
- 官方的定义：**高阶组件是参数为组件，返回值为新组件的函数**

进行解析如下：
- 首先，高阶组件 本身不是一个组件，而是一个函数；
- 其次，这个函数的参数是一个组件，返回值也是一个组件；

# 认识高阶组件

高阶组件的调用过程简化成：`const EnhancedComponent = hightOrderComponent(WrappedComponent)`

- `hightOrderComponent`：是指一个函数，函数参数中传入一个组件，并且会有一个返回值。
- `WrappedComponent`：是一个传入的组件
- `EnhancedComponent`：接收 `hightOrderComponent` 的返回值，返回值是一个函数（是一个组件）。

## 高阶组件的定义方式

在项目中创建文件为 `高阶组件的定义方式.js`，写入下面代码：

``` javascript
import React, { PureComponent } from 'react';

class App extends PureComponent {
    render() { 
        return (
            <div>hello world</div>
        );
    }
}

// 高阶组件的结构会与此类似
function enhanceComponent(WrappedComponent) {
    return class NewComponent extends PureComponent {
        render () {
            return <WrappedComponent />
        }
    }
}

const EnhanceComponent = enhanceComponent(App)
 
export default EnhanceComponent;
```

之后在 `index.js` 中引入 & 使用：

``` javascript
import React from 'react';
import ReactDOM from 'react-dom';
import App from "./高阶组件的定义方式"

ReactDOM.render(
  <App />,
  document.getElementById('root')
);
```

在浏览器中，利用安装的 `React Developer Tools` 插件，通过 `F12` 在 `Components` 模块下能够看到下面结构：

```
|- NewComponent
|- |- App
```

此时当你常使用 `enhanceComponent` 高阶函数时，都会包裹在定义好的 `NewComponent` 中。但是如果想为了调试起一个能**自定义包裹组件的名称时**。在 ES6 中，可以利用 ES6 中的 **类表达式[1]** 来定义包裹组件：`const NewComponent = class {...}`；在组件中，可以利用 `组件类.displayName = xxx` 来自定义显示在控制台中的名称。例如：

``` javascript
...
function enhanceComponent(WrappedComponent) {
    class NewComponent extends PureComponent {
        render () {
            return <WrappedComponent />
        }
    }
    NewComponent.displayName= "Jamediii"

    return NewComponent
}
...
```

结构就会更改为：

```
|- Jamediii
|- |- App
```

这时又有一个问题，当你想给高阶组件中被包裹组件 `WrappedComponent` 中传入属性时，属性都其实是传入给了包裹组件 `NewComponent` 中，但是既然都传给了包裹组件（也是父组件）中，那就可以通过 React 中的一个语法 `{...this.props}` 将所有传入给包裹组件中的属性都原封不动的传给被包裹组件中。关键性代码是：

``` javascript
...
class NewComponent extends PureComponent {
    render () {
        return <WrappedComponent {...this.props} />
    }
}
...
```

> 注意，这并不是 ES6 中的解构语法，是 React 中 jsx 的语法。

> 总结：高阶组件并不是 React API 中的一部分，它是基于 React 的组合特性而形成的一种设计模式；在一些 React 第三方库中非常常见，比如：
> - redux 中的 content；
> - react-router 中的 withRouter；

---
---

[1] [类表达式](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/class)：类表达式是用来定义类的一种语法。和 [函数表达式](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/function) 相同的一点是，类表达式可以是命名也可以是匿名的。如果是命名类表达式，这个名字只能在类体内部才能访问到。**JavaScript 的类也是基于原型继承的。**
- 语法：
``` javascript
const MyClass = class [className] [extends] {
  // class body
};
```
